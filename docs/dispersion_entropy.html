
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dispersion Entropy &#8212; SpKit</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/css/basic.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within SpKit"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/spkitlogo7.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ATAR - Automatic and Tunable Artifact Removal Algorithm for EEG" href="atar_algo.html" />
    <link rel="prev" title="Information Theory for Real-Valued signals" href="informationtheory.html" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>SpKit &#8212; Signal Processing Toolkit</title>
<link rel="stylesheet" href="../_static/css/nature1.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/pygments.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/gallery.css" type="text/css" />
<script type="text/javascript" id="documentation_options" data-url_root="./" src="../_static/js/documentation_options.js"></script>
<script type="text/javascript" src="../_static/js/jquery.js"></script>
<script type="text/javascript" src="../_static/js/underscore.js"></script>
<script type="text/javascript" src="../_static/js/doctools.js"></script>
<script type="text/javascript" src="../_static/js/copybutton.js"></script>
<link rel="shortcut icon" href="../_static/logo/spkit.ico"/>
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="signal processing, machine learning, wavelet analysis, information theory">

<script type="text/javascript">
  function updateTopMenuPosition(height, width) {
        if($(window).scrollTop() > height && $(window).outerWidth() > 1024) {
            //begin to scroll
            $('.related-wrapper').css("z-index", 1000)
            $('.related-wrapper').css("position", "sticky")
            $('.related-wrapper').css("top", 0)
            $('.related-wrapper').css("width", width)
        } else {
            //lock it back into place
            $('.related-wrapper').css("position", "relative")
            $('.related-wrapper').css("top", 0)
        }
    }

    $(function() {
        var banner_height = $('#logo-banner').outerHeight()
        var banner_width = $('#logo-banner').outerWidth()
        var width = $('.related-wrapper').css("height", $('.related').outerHeight())

        updateTopMenuPosition(banner_height, width)

        $(window).scroll(function(event) {
            updateTopMenuPosition(banner_height, width)
        });

        $(window).resize(function(event) {
            var banner_width = $('#logo-banner').outerWidth()
            var menu_height = $('.related').outerHeight()
            $('.related').css("width", banner_width)
            $('.related-wrapper').css("height", menu_height)
            updateTopMenuPosition(banner_height, width)
        })
    });

    </script>

<script type="text/javascript" src="../assets/js/jquery.jcarousel.min.js"></script>
<script type="text/javascript">
  (function($) {
      $(function() {
    $('.jcarousel').jcarousel();
          $('.jcarousel-control-prev')
              .on('active.jcarouselcontrol', function() {
                  $(this).removeClass('inactive');
              })
              .on('inactive.jcarouselcontrol', function() {
                  $(this).addClass('inactive');
              })
              .jcarouselControl({
                  target: '-=1'
              });

          $('.jcarousel-control-next')
              .on('active.jcarouselcontrol', function() {
                  $(this).removeClass('inactive');
              })
              .on('inactive.jcarouselcontrol', function() {
                  $(this).addClass('inactive');
              })
              .jcarouselControl({
                  target: '+=1'
              });

          $('.jcarousel-pagination')
              .on('active.jcarouselpagination', 'a', function() {
                  $(this).addClass('active');
              })
              .on('inactive.jcarouselpagination', 'a', function() {
                  $(this).removeClass('active');
              })
              .jcarouselPagination();
      });
  })(jQuery);
  </script>
<!-- Global site tag (gtag.js) - Google Analytics -->


  <div id="logo-banner">
    <div class="logo">
    <a href="https://spkit.github.io"><img src="../_static/logo/logo.png" alt="spkit logo"  border="0" /></a>
    </div>
    <div class="tags">
    <ul>
      <li>&#9672; Simple and easy to use toolkit for signal processing</li>
      <li>&#9672; Includes basic machine learning models with visualization</li>
      <li>&#9672; Open source</li>
    </ul>
    </div>
    <div class="banner">
    <h2>Signal Processing Toolkit</h2>
    <h4><i>Simple and easy to use for predictive analysis</i></h4>
    </div>
  </div>


  <div class=related-wrapper>
    <div class="related" role="navigation" aria-label="related navigation" background-color="#ffff">
    <ul>
    <li><a href="https://spkit.github.io">Home</a> |&nbsp;</li>
    <li><a href="https://spkit.github.io">User Guide</a> |&nbsp;</li>
    <li><a href="https://spkit.github.io">Examples</a> |&nbsp;</li>
    <li><a href="https://spkit.github.io">Tutorials</a> |&nbsp;</li>
    <li><a href="https://spkit.github.io">Updates</a> |&nbsp;</li>
    <li><a href="https://spkit.github.io">About</a> |&nbsp;</li>
    </ul>
    </div>
  </div>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="atar_algo.html" title="ATAR - Automatic and Tunable Artifact Removal Algorithm for EEG"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="informationtheory.html" title="Information Theory for Real-Valued signals"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SpKit</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Dispersion Entropy</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dispersion-entropy">
<h1>Dispersion Entropy<a class="headerlink" href="#dispersion-entropy" title="Permalink to this heading">¶</a></h1>
<a class="reference external image-reference" href="https://nbviewer.org/github/Nikeshbajaj/Notebooks/blob/master/spkit/SP/Dispersion_Entropy_1_demo_EEG.ipynb"><img alt="https://raw.githubusercontent.com/spkit/spkit.github.io/master/assets/images/nav_logo.svg" class="align-right" src="https://raw.githubusercontent.com/spkit/spkit.github.io/master/assets/images/nav_logo.svg" width="200" /></a>
<hr class="docutils" />
<div class="section" id="backgorund">
<h2>Backgorund<a class="headerlink" href="#backgorund" title="Permalink to this heading">¶</a></h2>
<p>Unlike usual entropy, Dispersion Entropy take the temporal dependency into accounts, same as Sample Entropy and Aproximate Entropy. It is Embeding Based Entropy function. The idea of Dispersion is almost same as Sample and Aproximate, which is to extract Embeddings, estimate their distribuation and compute entropy. However, there is a fine detail that make dispersion entropy more usuful.</p>
<ul class="simple">
<li><p>First, is to map the distribuation original signal to uniform (using CDF), then divide them into n-classes. This is same as done for quantization process of any normally distributed signal, such as speech. In quantization, this mapping helps to minimize the quantization error, by assiging small quantization steps for samples with high density and large for low. Think this in a way, if in a signal, large number of samples belongs to a range (-0.1, 0.1), near to zero, your almost all the embeddings will have at least one value that is in that range. CDF mapping will avoid that. In this python implimentation, we have included other mapping functions, which are commonly used in speech processing, i.e. A-Law, and µ-Law, with parameter A and µ to control the mapping.</p></li>
<li><p>Second, it allows to extract Embedding with delay factor, i.e. if delay is 2, an embeding is continues samples skiping everu other sample. which is kind of decimation. This helps if your signal is sampled at very high sampling frequecy, i.e. super smooth in local region. Consider you hhave a signal with very high smapling rate, then many of the continues samples will have similar values, which will lead to have a very high number of contant embeddings.</p></li>
<li><p>Third, actuall not so much of third, but an alternative to deal with signal with very high sampling rate, is by scale factor, which is nothing but a decimator.</p></li>
</ul>
</div>
<div class="section" id="an-example">
<h2>An Example<a class="headerlink" href="#an-example" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">spkit</span> <span class="k">as</span> <span class="nn">sp</span>

<span class="n">X</span><span class="p">,</span><span class="n">ch_names</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">load_data</span><span class="o">.</span><span class="n">eegSample</span><span class="p">()</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">128</span>

<span class="c1">#filtering</span>
<span class="n">Xf</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">filter_X</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">band</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">Xi</span> <span class="o">=</span> <span class="n">Xf</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># only one channel</span>

<span class="n">de</span><span class="p">,</span><span class="n">prob</span><span class="p">,</span><span class="n">patterns_dict</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">de</span><span class="p">)</span>
</pre></div>
</div>
<p>2.271749287746759</p>
<div class="section" id="important-note-log-base">
<h3>Important Note:  <strong>Log base</strong><a class="headerlink" href="#important-note-log-base" title="Permalink to this heading">¶</a></h3>
<p>The Entropy here is computed as  <span class="math notranslate nohighlight">\(-\sum p(x)log_e (p(x))\)</span> , natural log. <strong>To convert to log2, simply divide the value with np.log(2)</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>3.2774414315752844</p>
<p><strong>Probability of all the patterns found</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;pattern #&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_pat_1.png" src="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_pat_1.png" />
<p>Pattern dictionary</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">patterns_dict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">18</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">23</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
 <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
</pre></div>
</div>
<p>top 10 patters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="n">patterns_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">patterns_dict</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">PP</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">PP</span><span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">10</span><span class="p">],:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="embedding-diamension-4">
<h2>Embedding diamension 4<a class="headerlink" href="#embedding-diamension-4" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de</span><span class="p">,</span><span class="n">prob</span><span class="p">,</span><span class="n">patterns_dict</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">de</span>
</pre></div>
</div>
<p>4.86637389336799</p>
<p>top 10 patters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="p">[</span><span class="n">patterns_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">patterns_dict</span><span class="p">])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">PP</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">PP</span><span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">10</span><span class="p">],:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</pre></div>
</div>
<p>top-10, non-constant pattern</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Ptop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">PP</span><span class="p">[</span><span class="n">idx</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ptop</span><span class="o">-</span><span class="n">Ptop</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ptop</span><span class="p">[</span><span class="n">idx2</span><span class="p">[:</span><span class="mi">10</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="s1">&#39;--o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/DE_Patt1.png" src="../_images/DE_Patt1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ptop</span><span class="p">[</span><span class="n">idx2</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/DE_Patt2.png" src="../_images/DE_Patt2.png" />
</div>
<div class="section" id="dispersion-entropy-with-sliding-window">
<h2>Dispersion Entropy with sliding window<a class="headerlink" href="#dispersion-entropy-with-sliding-window" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de_temporal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">win</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="k">while</span> <span class="n">win</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="n">Xi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">de</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">[</span><span class="n">win</span><span class="p">],</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">win</span><span class="o">+=</span><span class="mi">16</span>
    <span class="n">de_temporal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">de</span><span class="p">)</span><span class="n">x</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">de_temporal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">de_temporal</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;window&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dispersion Entropy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_temp_1.png" src="https://raw.githubusercontent.com/Nikeshbajaj/spkit/master/figures/DE_temp_1.png" />
</div>
<div class="section" id="dispersion-entropy-multiscale">
<h2>Dispersion Entropy multiscale<a class="headerlink" href="#dispersion-entropy-multiscale" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">scl</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]:</span>
   <span class="n">de</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scl</span><span class="p">,</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sacle: </span><span class="si">{</span><span class="n">scl</span><span class="si">}</span><span class="s1">, </span><span class="se">\t</span><span class="s1">: DE: </span><span class="si">{</span><span class="n">de</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sacle</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.271749287746759</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.5456280627759336</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.6984938704051236</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>    <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.682837351130069</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>   <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.5585556625642476</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>   <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.7480275694000103</span>
<span class="n">Sacle</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>   <span class="p">:</span> <span class="n">DE</span><span class="p">:</span> <span class="mf">2.4767472897625806</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="mltiscale-refined-dispersion-entropy">
<h2>Mltiscale-refined Dispersion Entropy<a class="headerlink" href="#mltiscale-refined-dispersion-entropy" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy_multiscale_refined</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span><span class="n">classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">emb_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">de</span><span class="p">)</span>
</pre></div>
</div>
<p>2.543855087400606</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">dispersion_entropy_multiscale_refined</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2><a class="reference external" href="https://nbviewer.org/github/Nikeshbajaj/Notebooks/blob/master/spkit/SP/Dispersion_Entropy_1_demo_EEG.ipynb">View in Jupyter-Notebook for details</a><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<a class="reference external image-reference" href="https://nbviewer.org/github/Nikeshbajaj/Notebooks/blob/master/spkit/SP/Dispersion_Entropy_1_demo_EEG.ipynb"><img alt="https://raw.githubusercontent.com/spkit/spkit.github.io/master/assets/images/nav_logo.svg" class="align-right" src="https://raw.githubusercontent.com/spkit/spkit.github.io/master/assets/images/nav_logo.svg" width="100" /></a>
<hr class="docutils" />
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Dispersion Entropy</a><ul>
<li><a class="reference internal" href="#backgorund">Backgorund</a></li>
<li><a class="reference internal" href="#an-example">An Example</a><ul>
<li><a class="reference internal" href="#important-note-log-base">Important Note:  <strong>Log base</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#embedding-diamension-4">Embedding diamension 4</a></li>
<li><a class="reference internal" href="#dispersion-entropy-with-sliding-window">Dispersion Entropy with sliding window</a></li>
<li><a class="reference internal" href="#dispersion-entropy-multiscale">Dispersion Entropy multiscale</a></li>
<li><a class="reference internal" href="#mltiscale-refined-dispersion-entropy">Mltiscale-refined Dispersion Entropy</a></li>
<li><a class="reference internal" href="#id1">View in Jupyter-Notebook for details</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="informationtheory.html"
                          title="previous chapter">Information Theory for Real-Valued signals</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="atar_algo.html"
                          title="next chapter">ATAR - Automatic and Tunable Artifact Removal Algorithm for EEG</a></p>
  </div><div>
<h3>Quick links</h3>
<ul>
<li><a href="https://spkit.github.io"><img src="../_static/spkitlogo5.png" height="16" width="16" alt="" /> Homepage</a></li>
<li><a href="https://github.com/Nikeshbajaj/spkit/fork"><img src="../_static/github_logo1.png" height="16" width="16" alt="" /> Fork me on Github</a></li>
<li><a href="https://groups.google.com/g/spkit"><img src="../_static/comments_2.png" height="16" width="16" alt="" /> Discussion Group</a></li>
<li><a href="https://spkit.github.io/examples/"><img src="../_static/spkitlogo6.png" height="16" width="16" alt="" /> Examples Gellary</a></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="atar_algo.html" title="ATAR - Automatic and Tunable Artifact Removal Algorithm for EEG"
             >next</a> |</li>
        <li class="right" >
          <a href="informationtheory.html" title="Information Theory for Real-Valued signals"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SpKit</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Dispersion Entropy</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019-2022, Nikesh Bajaj.
      Last updated on Nov 12, 2022.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>